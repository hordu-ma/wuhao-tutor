# è§’è‰²ç³»ç»Ÿç®€åŒ–ä¿®æ”¹æ¸…å•

## æ€»ä½“ç›®æ ‡

å°†å½“å‰æ”¯æŒå¤šè§’è‰²(student/parent/teacher)çš„ç³»ç»Ÿç®€åŒ–ä¸ºåªæ”¯æŒå­¦ç”Ÿè§’è‰²(student)ï¼Œå¤§å¹…åº¦ç®€åŒ–ç³»ç»Ÿé€»è¾‘å’Œå¤æ‚åº¦ã€‚

## å½±å“åˆ†æ

### 1. å‰ç«¯å°ç¨‹åº (miniprogram/)

#### æ ¸å¿ƒç®¡ç†æ–‡ä»¶

- **utils/tabbar-manager.js** - ç§»é™¤ parentã€teacher é…ç½®ï¼Œåªä¿ç•™ student TabBar
- **utils/role-manager.js** - å®Œå…¨ç®€åŒ–æˆ–ç§»é™¤ï¼Œåªä¿ç•™ student è§’è‰²é…ç½®
- **utils/auth.js** - ç®€åŒ– getUserRole æ–¹æ³•ï¼Œå›ºå®šè¿”å›'student'
- **utils/permission-manager.js** - å¤§å¹…ç®€åŒ–æƒé™æ£€æŸ¥é€»è¾‘
- **app.js** - ç®€åŒ–å…¨å±€è§’è‰²ç®¡ç†ï¼Œç§»é™¤è§’è‰²åˆ‡æ¢é€»è¾‘

#### é¡µé¢æ–‡ä»¶å½±å“

- **pages/_/_.js** - ç§»é™¤é¡µé¢ä¸­çš„è§’è‰²æ¡ä»¶åˆ¤æ–­
- **pages/_/_.wxml** - ç§»é™¤è§’è‰²ç›¸å…³çš„æ¡ä»¶æ¸²æŸ“ï¼ˆwx:if="{{role==='student'}}"ï¼‰
- **components/_/_.js** - ç§»é™¤ç»„ä»¶ä¸­çš„è§’è‰²é€»è¾‘

#### é…ç½®æ–‡ä»¶

- **app.json** - ç®€åŒ– tabBar é…ç½®ï¼Œå›ºå®šä¸º student ç‰ˆæœ¬
- **project.config.json** - æ— éœ€ä¿®æ”¹

### 2. åç«¯ API (src/)

#### æ¨¡å‹å±‚ (models/)

- **src/models/user.py** - ç§»é™¤æˆ–ç®€åŒ– UserRole æšä¸¾ï¼Œåªä¿ç•™ STUDENT
- **æ•°æ®åº“è¡¨ç»“æ„** - role å­—æ®µå¯ä¿ç•™ä½†å›ºå®šä¸º'student'

#### æœåŠ¡å±‚ (services/)

- **src/services/user_service.py** - ç§»é™¤è§’è‰²ç›¸å…³çš„å¤æ‚é€»è¾‘
- **src/services/auth_service.py** - ç®€åŒ–è®¤è¯é€»è¾‘ï¼Œé»˜è®¤ student è§’è‰²
- **src/services/analytics_service.py** - å·²ç»ä¸»è¦é’ˆå¯¹ student_idï¼Œå½±å“è¾ƒå°

#### API å±‚ (api/)

- **src/api/auth.py** - ç®€åŒ–ç™»å½•/æ³¨å†Œæ¥å£çš„è§’è‰²å¤„ç†
- **src/api/users.py** - ç§»é™¤è§’è‰²ç›¸å…³çš„æŸ¥è¯¢å’Œè¿‡æ»¤
- **src/core/security.py** - ç®€åŒ–æƒé™æ£€æŸ¥ä¸­é—´ä»¶

### 3. æ–‡æ¡£å’Œé…ç½®

#### é¡¹ç›®æ–‡æ¡£

- **README.md** - æ›´æ–°é¡¹ç›®ç®€ä»‹ï¼Œç§»é™¤å¤šè§’è‰²æè¿°
- **.github/copilot-instructions.md** - æ›´æ–°å¼€å‘æŒ‡ä»¤ï¼Œç®€åŒ–æ¶æ„è¯´æ˜
- **docs/miniprogram/user-role-system.md** - é‡å†™æˆ–åˆ é™¤
- **docs/api/** - æ›´æ–° API æ–‡æ¡£ï¼Œç§»é™¤è§’è‰²ç›¸å…³ç«¯ç‚¹

#### é…ç½®æ¨¡æ¿

- **config/templates/.env.example** - å¯èƒ½æ— éœ€ä¿®æ”¹
- **alembic/versions/** - å¯èƒ½éœ€è¦æ–°çš„è¿ç§»è„šæœ¬

### 4. æµ‹è¯•æ–‡ä»¶ (tests/)

- **tests/** - æ›´æ–°æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹ï¼Œç§»é™¤è§’è‰²ç›¸å…³æµ‹è¯•
- **æµ‹è¯•æ•°æ®** - ç®€åŒ–æµ‹è¯•ç”¨æˆ·åˆ›å»ºï¼Œå›ºå®šä¸º student è§’è‰²

## ä¿®æ”¹ä¼˜å…ˆçº§

### ğŸ”´ é«˜ä¼˜å…ˆçº§ (ç«‹å³è§£å†³ TabBar é—®é¢˜)

1. `miniprogram/utils/tabbar-manager.js` - ç§»é™¤ parent/teacher é…ç½®
2. `miniprogram/utils/auth.js` - å›ºå®š getUserRole è¿”å›'student'
3. `miniprogram/app.js` - ç®€åŒ–è§’è‰²ç®¡ç†é€»è¾‘

### ğŸŸ¡ ä¸­ä¼˜å…ˆçº§ (ç³»ç»Ÿç¨³å®šæ€§)

4. `miniprogram/utils/role-manager.js` - ç®€åŒ–æˆ–ç§»é™¤
5. `miniprogram/utils/permission-manager.js` - ç®€åŒ–æƒé™é€»è¾‘
6. `src/services/user_service.py` - ç®€åŒ–ç”¨æˆ·æœåŠ¡è§’è‰²é€»è¾‘
7. `src/models/user.py` - ç®€åŒ–ç”¨æˆ·æ¨¡å‹

### ğŸŸ¢ ä½ä¼˜å…ˆçº§ (æ–‡æ¡£å’Œæ¸…ç†)

8. æ–‡æ¡£æ›´æ–° (README.md, docs/, .github/)
9. æµ‹è¯•ç”¨ä¾‹æ›´æ–°
10. æ•°æ®åº“è¿ç§»è„šæœ¬(å¦‚éœ€è¦)

## é¢„æœŸæ•ˆæœ

### âœ… è§£å†³çš„é—®é¢˜

- TabBar æ˜¾ç¤ºä¸ä¸€è‡´é—®é¢˜
- å¤æ‚çš„è§’è‰²åˆ‡æ¢é€»è¾‘
- æƒé™æ£€æŸ¥çš„æ€§èƒ½å¼€é”€
- ä»£ç ç»´æŠ¤å¤æ‚åº¦

### âœ… ç³»ç»Ÿç®€åŒ–

- å‰ç«¯ä»£ç å‡å°‘çº¦ 30%çš„è§’è‰²ç›¸å…³é€»è¾‘
- åç«¯ API ç®€åŒ–æƒé™ä¸­é—´ä»¶
- æ–‡æ¡£å’Œæµ‹è¯•ç”¨ä¾‹å¤§å¹…ç®€åŒ–
- æ–°å¼€å‘è€…ç†è§£æˆæœ¬é™ä½

### âš ï¸ æ³¨æ„äº‹é¡¹

- ç°æœ‰æ•°æ®åº“ä¸­çš„ role å­—æ®µæ•°æ®éœ€è¦å¤„ç†
- ç¡®ä¿æ‰€æœ‰é¡µé¢å’Œç»„ä»¶éƒ½ç§»é™¤è§’è‰²ä¾èµ–
- API æ¥å£ä¿æŒå‘åå…¼å®¹æ€§
- å……åˆ†æµ‹è¯•ç®€åŒ–åçš„åŠŸèƒ½å®Œæ•´æ€§

## å®æ–½è®¡åˆ’

1. **é˜¶æ®µ 1**: å‰ç«¯ TabBar å’Œè®¤è¯ç®€åŒ– (è§£å†³å½“å‰é—®é¢˜)
2. **é˜¶æ®µ 2**: åç«¯è§’è‰²ç³»ç»Ÿç®€åŒ– (ç³»ç»Ÿä¸€è‡´æ€§)
3. **é˜¶æ®µ 3**: æ–‡æ¡£å’Œé…ç½®æ›´æ–° (å®Œæ•´æ€§)
4. **é˜¶æ®µ 4**: æµ‹è¯•éªŒè¯å’Œæ•°æ®åº“æ¸…ç† (ç¨³å®šæ€§)

æ¯ä¸ªé˜¶æ®µå®Œæˆåè¿›è¡ŒåŠŸèƒ½éªŒè¯ï¼Œç¡®ä¿ç³»ç»Ÿæ­£å¸¸è¿è¡Œã€‚
