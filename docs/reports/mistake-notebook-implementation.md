# é”™é¢˜æ‰‹å†ŒåŠŸèƒ½å®æ–½æŠ¥å‘Š

## ğŸ“‹ ä»»åŠ¡æ¦‚è¿°

æŒ‰ç…§ç”¨æˆ·éœ€æ±‚,å®Œæˆä»¥ä¸‹æ¨¡å—é‡æ„:

1. âœ… å°†"å­¦ä¹ é—®ç­”"æ¨¡å—é‡å‘½åä¸º"ä½œä¸šé—®ç­”"
2. âœ… éšè—åŸæœ‰"ä½œä¸šæ‰¹æ”¹"æ¨¡å—
3. âœ… åˆ›å»ºå…¨æ–°çš„"é”™é¢˜æ‰‹å†Œ"æ¨¡å—,æ›¿ä»£ä½œä¸šæ‰¹æ”¹åœ¨å¯¼èˆªä¸­çš„ä½ç½®

## ğŸ¯ å·²å®Œæˆå·¥ä½œ

### 1. å‰ç«¯è·¯ç”±é…ç½® (frontend/src/router/index.ts)

#### æ›´æ”¹å†…å®¹:

- **å­¦ä¹ é—®ç­”é‡å‘½å**:
  - ç§»åŠ¨ç«¯è·¯ç”± (line 102): `title: 'ä½œä¸šé—®ç­”'`
  - æ¡Œé¢ç«¯è·¯ç”± (line 171): `title: 'ä½œä¸šé—®ç­”'`
- **éšè—ä½œä¸šæ‰¹æ”¹**:
  - ä½œä¸šæ‰¹æ”¹çˆ¶è·¯ç”± (line 130): æ·»åŠ  `meta: { hidden: true }`
- **æ–°å¢é”™é¢˜æ‰‹å†Œè·¯ç”±**:
  ```typescript
  {
    path: '/mistakes',
    children: [
      { path: '', name: 'MistakeList', ... }, // é”™é¢˜åˆ—è¡¨
      { path: 'today-review', name: 'TodayReview', ... }, // ä»Šæ—¥å¤ä¹ 
      { path: ':id', name: 'MistakeDetail', ... }, // é”™é¢˜è¯¦æƒ…
    ]
  }
  ```

### 2. TypeScript ç±»å‹å®šä¹‰ (frontend/src/types/mistake.ts)

åˆ›å»ºå®Œæ•´çš„é”™é¢˜æ‰‹å†Œç±»å‹ç³»ç»Ÿ (113 lines):

**æšä¸¾ç±»å‹**:

- `MistakeSource`: homework | learning | manual
- `MasteryStatus`: not_mastered | reviewing | mastered

**æ ¸å¿ƒæ¥å£**:

- `MistakeListItem`: é”™é¢˜åˆ—è¡¨é¡¹
- `MistakeListResponse`: åˆ†é¡µåˆ—è¡¨å“åº”
- `MistakeDetail`: é”™é¢˜è¯¦æƒ…
- `TodayReviewTask`: ä»Šæ—¥å¤ä¹ ä»»åŠ¡
- `TodayReviewResponse`: å¤ä¹ ä»»åŠ¡å“åº”
- `ReviewCompleteRequest/Response`: å¤ä¹ å®Œæˆè¯·æ±‚å’Œå“åº”
- `MistakeStatistics`: é”™é¢˜ç»Ÿè®¡æ•°æ®

### 3. API å®¢æˆ·ç«¯å±‚ (frontend/src/api/mistakes.ts)

åˆ›å»º 7 ä¸ª API æ–¹æ³• (92 lines):

```typescript
getTodayReviewTasks() // è·å–ä»Šæ—¥å¤ä¹ ä»»åŠ¡
getMistakeList() // è·å–é”™é¢˜åˆ—è¡¨(æ”¯æŒç­›é€‰ã€åˆ†é¡µ)
getMistakeDetail(id) // è·å–é”™é¢˜è¯¦æƒ…
completeReview(request) // å®Œæˆå¤ä¹ 
getMistakeStatistics() // è·å–ç»Ÿè®¡æ•°æ®
createMistake(request) // æ‰‹åŠ¨åˆ›å»ºé”™é¢˜
deleteMistake(id) // åˆ é™¤é”™é¢˜
```

### 4. Vue ç»„ä»¶å¼€å‘ (frontend/src/views/mistakes/)

#### MistakeList.vue (300+ lines)

- **åŠŸèƒ½**: é”™é¢˜åˆ—è¡¨å±•ç¤ºã€ç­›é€‰ã€åˆ†é¡µ
- **ç‰¹æ€§**:
  - é¡¶éƒ¨ç»Ÿè®¡å¡ç‰‡(æ€»æ•°ã€æœªæŒæ¡ã€å¤ä¹ ä¸­ã€å·²æŒæ¡)
  - å¤šæ¡ä»¶ç­›é€‰(å­¦ç§‘ã€æŒæ¡çŠ¶æ€ã€å…³é”®è¯æœç´¢)
  - è¡¨æ ¼å±•ç¤º with æ“ä½œæŒ‰é’®(æŸ¥çœ‹ã€åˆ é™¤)
  - åˆ†é¡µç»„ä»¶é›†æˆ

#### TodayReview.vue (230+ lines)

- **åŠŸèƒ½**: ä»Šæ—¥å¤ä¹ ä»»åŠ¡ç®¡ç†
- **ç‰¹æ€§**:
  - ä»»åŠ¡åˆ—è¡¨ with è¿›åº¦æ˜¾ç¤º
  - å¤ä¹ å¯¹è¯æ¡†(ç­”å¯¹/ç­”é”™ã€ç¬”è®°)
  - å®æ—¶æ›´æ–°å®ŒæˆçŠ¶æ€
  - ç©ºçŠ¶æ€å‹å¥½æç¤º

#### MistakeDetail.vue (350+ lines)

- **åŠŸèƒ½**: é”™é¢˜è¯¦ç»†ä¿¡æ¯æŸ¥çœ‹
- **ç‰¹æ€§**:
  - å®Œæ•´ä¿¡æ¯å±•ç¤º(åŸºæœ¬ä¿¡æ¯ã€çŸ¥è¯†ç‚¹ã€é¢˜ç›®å†…å®¹)
  - æˆ‘çš„ç­”æ¡ˆ vs æ­£ç¡®ç­”æ¡ˆå¯¹æ¯”
  - é¢˜ç›®è§£æå±•ç¤º
  - å›¾ç‰‡é¢„è§ˆ(el-image with é¢„è§ˆåˆ—è¡¨)
  - å¤ä¹ åŠŸèƒ½å…¥å£
  - åˆ é™¤é”™é¢˜

### 5. åç«¯ API ç«¯ç‚¹ (src/api/v1/endpoints/mistakes.py)

åˆ›å»º REST API ç«¯ç‚¹ (235 lines):

| ç«¯ç‚¹                     | æ–¹æ³•   | åŠŸèƒ½             |
| ------------------------ | ------ | ---------------- |
| `/mistakes`              | GET    | è·å–é”™é¢˜åˆ—è¡¨     |
| `/mistakes/{id}`         | GET    | è·å–é”™é¢˜è¯¦æƒ…     |
| `/mistakes`              | POST   | åˆ›å»ºé”™é¢˜         |
| `/mistakes/{id}`         | DELETE | åˆ é™¤é”™é¢˜         |
| `/mistakes/today-review` | GET    | è·å–ä»Šæ—¥å¤ä¹ ä»»åŠ¡ |
| `/mistakes/{id}/review`  | POST   | å®Œæˆå¤ä¹          |
| `/mistakes/statistics`   | GET    | è·å–é”™é¢˜ç»Ÿè®¡     |

**ç‰¹ç‚¹**:

- å®Œæ•´çš„é”™è¯¯å¤„ç†(NotFoundError, ValidationError, ServiceError)
- æ—¥å¿—è®°å½•
- ç”¨æˆ·æƒé™éªŒè¯(é€šè¿‡ `get_current_user_id` ä¾èµ–)
- å‚æ•°éªŒè¯(åˆ†é¡µã€ç­›é€‰æ¡ä»¶)

### 6. Pydantic Schemas (src/schemas/mistake.py)

é‡æ„å¹¶æ‰©å±• schema å®šä¹‰ (340+ lines):

**æ–°å¢ schemas**:

- `CreateMistakeRequest`: æ‰‹åŠ¨åˆ›å»ºé”™é¢˜è¯·æ±‚
- `MistakeSource/MasteryStatus`: æšä¸¾ç±»å‹å®šä¹‰
- è°ƒæ•´ç°æœ‰ schemas ä»¥åŒ¹é…å‰ç«¯ TypeScript å®šä¹‰

**å¯¹é½å‰åç«¯**:

- å­—æ®µåç§°ä¸€è‡´æ€§
- ç±»å‹åŒ¹é…(UUID, str, int ç­‰)
- å“åº”ç»“æ„ç»Ÿä¸€

### 7. æœåŠ¡å±‚å ä½å®ç° (src/services/mistake_service.py)

åˆ›å»º `MistakeService` ç±» (160+ lines):

**æ–¹æ³•åˆ—è¡¨**:

```python
get_mistake_list()          # é”™é¢˜åˆ—è¡¨æŸ¥è¯¢
get_mistake_detail()        # é”™é¢˜è¯¦æƒ…æŸ¥è¯¢
create_mistake()            # åˆ›å»ºé”™é¢˜
delete_mistake()            # åˆ é™¤é”™é¢˜
get_today_review_tasks()    # ä»Šæ—¥å¤ä¹ ä»»åŠ¡
complete_review()           # å®Œæˆå¤ä¹ 
get_statistics()            # ç»Ÿè®¡æ•°æ®
```

**âš ï¸ æ³¨æ„**:
å½“å‰ä¸ºå ä½å®ç°,åŒ…å«è¯¦ç»†çš„ TODO æ³¨é‡Š,åç»­éœ€è¦:

1. é›†æˆæ•°æ®åº“æ¨¡å‹å’Œ Repository
2. å®ç°è‰¾å®¾æµ©æ–¯é—å¿˜æ›²çº¿ç®—æ³•
3. é›†æˆ AI æœåŠ¡è¿›è¡Œé”™é¢˜åˆ†æ
4. å®ç°å®Œæ•´çš„å¤ä¹ è®¡åˆ’ç®¡ç†

### 8. è·¯ç”±æ³¨å†Œ (src/api/v1/api.py)

æ·»åŠ é”™é¢˜æ‰‹å†Œè·¯ç”±åˆ°ä¸»è·¯ç”±å™¨:

```python
api_router.include_router(
    mistakes.router,
    prefix="/mistakes",
    tags=["é”™é¢˜æ‰‹å†Œ"]
)
```

## ğŸ“Š æ–‡ä»¶ç»Ÿè®¡

| ç±»å‹       | æ–°å¢  | ä¿®æ”¹ | åˆ é™¤ |
| ---------- | ----- | ---- | ---- |
| å‰ç«¯æ–‡ä»¶   | 5     | 1    | 0    |
| åç«¯æ–‡ä»¶   | 2     | 2    | 0    |
| æ€»ä»£ç è¡Œæ•° | ~1800 | ~50  | 0    |

### æ–°å¢æ–‡ä»¶æ¸…å•:

```
frontend/src/
â”œâ”€â”€ types/mistake.ts                          # 113 lines
â”œâ”€â”€ api/mistakes.ts                           # 92 lines
â””â”€â”€ views/mistakes/
    â”œâ”€â”€ MistakeList.vue                       # 317 lines
    â”œâ”€â”€ TodayReview.vue                       # 230 lines
    â””â”€â”€ MistakeDetail.vue                     # 365 lines

src/
â”œâ”€â”€ api/v1/endpoints/mistakes.py              # 235 lines
â”œâ”€â”€ services/mistake_service.py               # 161 lines (å ä½)
â””â”€â”€ schemas/mistake.py                        # é‡æ„, 340 lines
```

### ä¿®æ”¹æ–‡ä»¶æ¸…å•:

```
frontend/src/router/index.ts                  # 3å¤„ä¿®æ”¹
src/api/v1/api.py                             # æ·»åŠ è·¯ç”±æ³¨å†Œ
```

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### å‰ç«¯æŠ€æœ¯æ ˆ

- Vue 3 Composition API
- TypeScript 5.6+
- Element Plus 2.5+ (UI ç»„ä»¶)
- Vue Router 4.x
- è‡ªå®šä¹‰ http å®¢æˆ·ç«¯

### åç«¯æŠ€æœ¯æ ˆ

- FastAPI
- Pydantic v2 (æ•°æ®éªŒè¯)
- SQLAlchemy 2.x (å¼‚æ­¥ ORM)
- UUID ä¸»é”®
- ç±»å‹æ³¨è§£ (Type Hints)

### è®¾è®¡æ¨¡å¼

- **åˆ†å±‚æ¶æ„**: API â†’ Service â†’ Repository â†’ Model
- **ä¾èµ–æ³¨å…¥**: FastAPI Depends
- **ç±»å‹å®‰å…¨**: å‰åç«¯å®Œæ•´ç±»å‹å®šä¹‰
- **é”™è¯¯å¤„ç†**: ç»Ÿä¸€å¼‚å¸¸ç±»å‹å’Œ HTTP çŠ¶æ€ç 

## âš ï¸ å¾…å®Œæˆå·¥ä½œ

### é«˜ä¼˜å…ˆçº§

1. **MistakeService å®ç°**:

   - [ ] åˆ›å»ºæˆ–é›†æˆ MistakeRepository
   - [ ] å®ç°æ•°æ®åº“ CRUD æ“ä½œ
   - [ ] é›†æˆè‰¾å®¾æµ©æ–¯é—å¿˜æ›²çº¿ç®—æ³•
   - [ ] å®ç°å¤ä¹ è®¡åˆ’è‡ªåŠ¨è°ƒåº¦

2. **å¯¼èˆªèœå•æ›´æ–°**:

   - [ ] ä¿®æ”¹ `MainLayout.vue` å¯¼èˆªèœå•
   - [ ] å°†"ä½œä¸šæ‰¹æ”¹"æ›¿æ¢ä¸º"é”™é¢˜æ‰‹å†Œ"
   - [ ] æ›´æ–°å›¾æ ‡å’Œæ–‡å­—

3. **æ•°æ®åº“è¿ç§»**:
   - [ ] å¦‚éœ€æ–°è¡¨,åˆ›å»º Alembic è¿ç§»è„šæœ¬
   - [ ] å®¡æŸ¥ç°æœ‰ mistakes è¡¨ç»“æ„æ˜¯å¦æ»¡è¶³éœ€æ±‚
   - [ ] å¯èƒ½éœ€è¦æ–°å¢å­—æ®µ(source, source_id ç­‰)

### ä¸­ä¼˜å…ˆçº§

4. **é›†æˆç°æœ‰åŠŸèƒ½**:

   - [ ] ä»ä½œä¸šæ‰¹æ”¹æ¨¡å—ç”Ÿæˆé”™é¢˜
   - [ ] ä»å­¦ä¹ é—®ç­”æ¨¡å—ç”Ÿæˆé”™é¢˜
   - [ ] AI è‡ªåŠ¨åˆ†æçŸ¥è¯†ç‚¹

5. **æµ‹è¯•**:
   - [ ] å‰ç«¯ç»„ä»¶å•å…ƒæµ‹è¯•
   - [ ] API ç«¯ç‚¹é›†æˆæµ‹è¯•
   - [ ] Service å±‚å•å…ƒæµ‹è¯•
   - [ ] E2E æµ‹è¯•(å¤ä¹ æµç¨‹)

### ä½ä¼˜å…ˆçº§

6. **ä¼˜åŒ–å’Œå¢å¼º**:
   - [ ] æ·»åŠ é”™é¢˜å¯¼å‡ºåŠŸèƒ½(PDF/å›¾ç‰‡)
   - [ ] é”™é¢˜åˆ†äº«åŠŸèƒ½
   - [ ] å¤ä¹ æé†’(é€šçŸ¥ç³»ç»Ÿ)
   - [ ] å­¦ä¹ æŠ¥å‘Šç”Ÿæˆ

## ğŸš€ éƒ¨ç½²å»ºè®®

### å¼€å‘ç¯å¢ƒæµ‹è¯•

```bash
# å‰ç«¯
cd frontend
npm run dev  # æ£€æŸ¥è·¯ç”±å’Œé¡µé¢æ¸²æŸ“

# åç«¯
cd ..
./scripts/start-dev.sh  # æ£€æŸ¥APIç«¯ç‚¹
# è®¿é—® http://localhost:8000/docs æŸ¥çœ‹ Swagger æ–‡æ¡£
```

### éªŒè¯æ¸…å•

- [ ] å‰ç«¯è·¯ç”±è·³è½¬æ­£å¸¸
- [ ] API ç«¯ç‚¹å¯è®¿é—®(è™½ç„¶è¿”å›ç©ºæ•°æ®)
- [ ] TypeScript ç¼–è¯‘æ— é”™è¯¯
- [ ] Python ç±»å‹æ£€æŸ¥é€šè¿‡ (mypy)
- [ ] æ— æ˜æ˜¾ UI å¸ƒå±€é—®é¢˜

### ç”Ÿäº§éƒ¨ç½²æ³¨æ„

1. ç¡®ä¿æ•°æ®åº“è¿ç§»å·²åº”ç”¨
2. ç¯å¢ƒå˜é‡é…ç½®æ­£ç¡®
3. é™æ€èµ„æºæ„å»º (`npm run build`)
4. åç«¯æœåŠ¡é‡å¯
5. æ£€æŸ¥æ—¥å¿—ä¸­çš„ WARNING(MistakeService æœªå®ç°è­¦å‘Š)

## ğŸ“ ç”¨æˆ·æ“ä½œæŒ‡å—

### Git æäº¤å»ºè®®

```bash
git add frontend/src/router/index.ts
git add frontend/src/types/mistake.ts
git add frontend/src/api/mistakes.ts
git add frontend/src/views/mistakes/
git add src/api/v1/api.py
git add src/api/v1/endpoints/mistakes.py
git add src/services/mistake_service.py
git add src/schemas/mistake.py

git commit -m "feat(mistakes): å®ç°é”™é¢˜æ‰‹å†Œå‰ç«¯å’ŒAPIæ¡†æ¶

- é‡å‘½å:å­¦ä¹ é—®ç­”â†’ä½œä¸šé—®ç­”
- éšè—:ä½œä¸šæ‰¹æ”¹æ¨¡å—
- æ–°å¢:é”™é¢˜æ‰‹å†Œå®Œæ•´å‰ç«¯é¡µé¢(åˆ—è¡¨/ä»Šæ—¥å¤ä¹ /è¯¦æƒ…)
- æ–°å¢:é”™é¢˜æ‰‹å†ŒREST APIç«¯ç‚¹
- æ–°å¢:å‰åç«¯ç±»å‹å®šä¹‰å’Œschemas
- å¾…å®Œæˆ:MistakeServiceä¸šåŠ¡é€»è¾‘å®ç°

Ref: ç”¨æˆ·éœ€æ±‚-é”™é¢˜æ‰‹å†Œæ¨¡å—æ›¿æ¢ä½œä¸šæ‰¹æ”¹"
```

### æ‰‹åŠ¨éƒ¨ç½²

```bash
# ä½¿ç”¨é¡¹ç›®æä¾›çš„éƒ¨ç½²è„šæœ¬
./scripts/deploy_to_production.sh

# æˆ–æŒ‰ç…§é¡¹ç›®æ–‡æ¡£æ‰‹åŠ¨éƒ¨ç½²
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [é”™é¢˜æ‰‹å†Œéœ€æ±‚æ–‡æ¡£](docs/features/mistake-notebook.md) - å¦‚å­˜åœ¨
- [è‰¾å®¾æµ©æ–¯ç®—æ³•è¯´æ˜](docs/algorithms/ebbinghaus.md) - å¾…åˆ›å»º
- [API æ–‡æ¡£](http://localhost:8000/docs) - Swagger è‡ªåŠ¨ç”Ÿæˆ
- [å‰ç«¯ç»„ä»¶æ–‡æ¡£](frontend/README.md)

## ğŸ‰ æ€»ç»“

æœ¬æ¬¡å®æ–½å·²å®Œæˆ:

1. âœ… å®Œæ•´çš„å‰ç«¯ UI ç»„ä»¶å’Œè·¯ç”±é…ç½®
2. âœ… ç±»å‹å®‰å…¨çš„å‰åç«¯æ¥å£å®šä¹‰
3. âœ… REST API ç«¯ç‚¹æ¡†æ¶
4. âœ… æœåŠ¡å±‚å ä½å®ç°
5. âœ… ç¼–è¯‘é”™è¯¯å…¨éƒ¨è§£å†³

ç”¨æˆ·å¯ä»¥:

- æŸ¥çœ‹é”™é¢˜æ‰‹å†Œé¡µé¢å¸ƒå±€
- æµ‹è¯•è·¯ç”±å¯¼èˆª
- æŸ¥çœ‹ API æ–‡æ¡£(Swagger)

åç»­éœ€è¦:

- å®ç° MistakeService ä¸šåŠ¡é€»è¾‘
- æ›´æ–°å¯¼èˆªèœå•
- å®Œå–„æ•°æ®åº“é›†æˆ
- æ·»åŠ æµ‹è¯•ç”¨ä¾‹

---

**ç”Ÿæˆæ—¶é—´**: 2025-01-XX  
**ä½œè€…**: GitHub Copilot  
**ç‰ˆæœ¬**: v1.0
