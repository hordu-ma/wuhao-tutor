# 五好伴学项目状态总览 (STATUS)

Last Updated: 2025-09-29
当前版本标签（后端应用）：0.1.0-dev
文档重构：阶段 1 / 3（骨架已建立，内容迁移中）

---

## 1. 快速概览 (Executive Summary)

| 维度 | 当前状态 | 完成度估算 | 说明 |
|------|----------|------------|------|
| 核心后端功能 | 作业批改 / 学习问答 / 学情分析框架 | 90% | 学情分析算法深化与指标化待补充 |
| AI 服务集成 | 百炼智能体统一封装 | 95% | 支持扩展模型策略与调用链监控 |
| API 稳定性 | v1 设计稳定，无破坏性变更 | 85% | 需补充速率限制策略在文档化 |
| 数据访问层 | 仓储层 + 业务查询聚合 | 90% | 后续引入缓存策略说明 |
| 性能监控 | 基础指标 / 慢查询 / 限流 | 80% | 指标导出与可视化待集成（Prometheus/Grafana 衔接） |
| 安全与生产部署 | 安全头 / 限流 / Docker / Nginx / 密钥管理 | 90% | 增强证书自动化与告警体系 |
| 测试体系 | 单元 / 集成 / 性能基础 | 70% | 覆盖率统计与基线报告缺失 |
| 文档体系 | 重构中（骨架已成型） | 40% | 拆分迁移 + 术语表 + API 模块化待完成 |
| 前端集成 | 前端结构与接口适配 | 70% | 需补“前后端错误契约 / 限流提示” |
| 部署与运维 | 脚本、备份、回滚、环境管理 | 85% | 加自动健康巡检与日志聚合说明 |

---

## 2. 里程碑与阶段

| 阶段 | 内容摘要 | 状态 | 交付标记 | 备注 |
|------|---------|------|-----------|------|
| 5.2 | API 文档与测试完善 | ✅ 完成 | API 长文初稿 | 已拆分规划（待迁移） |
| 5.3 | PostgreSQL 迁移与脚本体系 | ✅ 完成 | init / migrate / backup | 生产形态可用 |
| 5.4 | 性能优化与监控框架 | ✅ 完成 | 中间件 / 限流 / 指标 | 待接入可视化 |
| 5.5 | 安全性与生产部署 | ✅ 完成 | 安全头 / Docker / Nginx / Secrets | 证书自动化下一步 |
| 6.x | 前端界面集成与 UX 强化 | 进行中 | 组件化 / API 绑定 | 学情分析 UI 未完成 |
| 文档重构 | 结构化拆分与统一规范 | 进行中 | 新 docs/ 体系 | 当前为第 1 轮迁移 |
| 稳定版 (v1.0.0) | 可对外试用版本 | 规划中 | 需完成质量基线 | 需测试覆盖度与变更冻结 |
| 可观测增强 | Prometheus + 告警 | 规划中 | 指标导出适配 | 与部署集成 |

---

## 3. 当前功能矩阵

| 模块 | 子功能 | 状态 | 说明 |
|------|--------|------|------|
| 作业批改 | 模板 / 提交 / 批改结果 | ✅ | AI 评分解释结构已定义 |
| 作业批改 | 批改策略调优 | ⏳ | 计划引入评分维度权重配置 |
| 学习问答 | 会话管理 / 上下文记忆 | ✅ | 需补“知识强化”策略 |
| 学习问答 | 答案来源追踪 | ⏳ | 计划引入引用片段结构 |
| 学情分析 | 活跃/频次统计 | ✅ | 指标采集已基础完成 |
| 学情分析 | 知识点掌握推断 | ⏳ | 需算法策略与权重说明 |
| 文件管理 | 上传 / 下载 / 预览 | ✅ | 缺防病毒/内容合规（未来） |
| 健康检查 | 活性/就绪/性能扩展 | ✅ | 已支持分层端点 |
| 性能监控 | 请求延迟 / 分位数 | ✅ | 需 Prometheus exporter |
| 限流 | IP / 用户 / AI 调用 / 登录 | ✅ | 需在 SECURITY.md 补策略表 |
| 安全头 | CSP / HSTS / CSP 分环境 | ✅ | 已生产对齐 |
| 数据访问 | BaseRepository / 业务仓储 | ✅ | 增缓存策略说明（待写） |
| 数据库 | 迁移 / 初始化 / 备份 | ✅ | 备份轮转策略可强化 |
| 部署 | Docker / Compose / Nginx | ✅ | K8s 未来规划 |
| 密钥管理 | 自动生成 / 权限控制 | ✅ | 计划轮换策略自动化 |
| 测试 | 单元 / 集成 / 性能脚本 | 部分 | 需补：覆盖率报告与阈值基线 |

---

## 4. 关键技术指标（目前手工汇总）

| 指标 | 当前值 (示例态) | 基线/目标 | 状态 |
|------|----------------|----------|------|
| 平均 API 响应 (核心端点) | 90–130ms | < 200ms | ✅ |
| p95 响应时间 | ~280ms | < 500ms | ✅ |
| 错误率 (5xx) | < 0.5% | < 1% | ✅ |
| 缓存命中率 (规划) | N/A | ≥ 60% (热点查询) | 待实现 |
| 慢查询记录 | 支持统计（阈值=0.5s prod） | 持续收集 | ✅ |
| 限流误杀率 | 未统计 | < 0.1% | 待添加观测 |
| 代码类型检查错误 | 0 | 0 | ✅ |
| 单元测试覆盖率 | 未基线化 | ≥ 75% | 待接入 |
| 配置漂移检查 | 手动 | 自动化脚本 | 规划中 |
| 发布回滚耗时 | < 5 分钟 (Compose) | < 5 分钟 | ✅ |

> 注：后续将把指标采集与 `OBSERVABILITY.md` 联动。

---

## 5. 风险与关注点 (Risk Register)

| 编号 | 类型 | 描述 | 影响 | 当前缓解措施 | 下一步 |
|------|------|------|------|--------------|--------|
| R1 | 功能一致性 | 旧文档残留术语不统一 | 中 | 文档重构中 | 术语表上线后全局校验 |
| R2 | 学情分析 | 算法策略尚未固化 | 中 | 指标框架已预留 | 定义指标 + 核心计算单测 |
| R3 | 覆盖率 | 测试覆盖率未量化 | 中 | 已有测试基础 | 接入 coverage + 阈值 |
| R4 | 监控闭环 | 缺告警与可视化 | 中 | 指标采集可用 | 接入 Prometheus Export |
| R5 | 缓存策略 | 热点查询未缓存 | 中 | 结构预留 | 设计缓存层策略 |
| R6 | 安全运营 | 密钥轮换未自动化 | 低 | 脚本生成 | 增加轮换计划与审计日志 |
| R7 | 变更管控 | 尚未建立冻结期机制 | 低 | 手工评审 | 发布前引入 freeze 阶段 |
| R8 | 前后端契约 | 错误码文档未拆出 | 中 | 代码内嵌 | 拆出 api/errors.md |

---

## 6. 下一阶段 (Short-Term Action Plan)

| 优先级 | 任务 | 目标 | 预计 |
|--------|------|------|------|
| P0 | API 文档拆分迁移 | 减少 600+ 行长文件 | 1 日 |
| P0 | 术语表初稿 | 去歧义/统一词表 | 0.5 日 |
| P0 | 错误与错误码清单 | 前后端统一处理策略 | 0.5 日 |
| P1 | OBSERVABILITY.md 初稿 | 指标 + 监控端点说明 | 0.5 日 |
| P1 | 覆盖率统计集成 | 生成 coverage 报告 | 0.5 日 |
| P1 | 学情分析指标定义 | 设计数据采集 schema | 1 日 |
| P2 | 缓存策略设计 | 冷/热数据分类策略 | 1 日 |
| P2 | Prometheus 导出接入 | 形成可视化基础 | 1 日 |
| P2 | 密钥轮换机制文档 | 规范周期与执行 | 0.5 日 |
| P3 | CHANGELOG 初始化 | 引入发布节奏 | 0.2 日 |
| P3 | FRONTEND-INTEGRATION.md | 错误 & 限流提示规范 | 0.5 日 |

---

## 7. 时间轴 (High-Level Timeline)

| 时间区间 | 事件 / 阶段 |
|----------|------------|
| 2024-Q4 | 后端基础与 AI 集成验证 |
| 2025-Q1 | 安全与部署体系完善（5.5 完成） |
| 2025-Q2 | 前端功能扩展 / 学情分析深化（进行中） |
| 2025-Q3 | 监控与性能体系强化 / 文档重构启动 |
| 2025-Q4 | 准备 v1.0.0 稳定发布（规划） |

---

## 8. 发布与版本计划 (Release Planning)

| 版本 | 类型 | 目标 | 备注 |
|------|------|------|------|
| 0.1.x | 内部迭代 | 功能拼装 + 骨架稳定 | 当前阶段 |
| 0.2.x | 补完测试 + 学情分析初版 | 引入覆盖率指标基线 | 规划 |
| 0.3.x | 监控闭环 / 缓存层上线 | Prometheus 导出 | 规划 |
| 0.4.x | 前后端契约固化 / 文档成熟 | 用于小范围试用 | 规划 |
| 1.0.0 | 稳定版 | 完整文档 / 指标监控 / 回滚策略成熟 | 需冻结期 |

---

## 9. 文档重构追踪 (Documentation Refactor Tracker)

| 文件 | 状态 | 说明 |
|------|------|------|
| docs/README.md | ✅ | 文档索引完成 |
| STATUS.md | ✅ | 初始化 |
| ARCHITECTURE.md | ⏳ | 待抽取 dev-guide 结构部分 |
| DEVELOPMENT.md | ⏳ | 待整理原 dev-guide 环境篇 |
| DATA-ACCESS.md | ⏳ | 待裁剪 repositories/README |
| API 拆分文件 | ⏳ | 从 `docs/api.md` 迁移 |
| SECURITY.md | ⏳ | 从 5.5 总结抽出 |
| OBSERVABILITY.md | ⏳ | 从 5.4 + 运行逻辑整理 |
| TESTING.md | ⏳ | 集成测试与策略提炼 |
| FRONTEND-INTEGRATION.md | ⏳ | 错误码 + 显示策略 |
| GLOSSARY.md | ⏳ | 术语抽离 |
| MIGRATION.md | ⏳ | 脚本 + Alembic 流程 |
| CHANGELOG.md | 未创建 | 初始化 0.1.0 条目 |
| history/ | ✅ | 5.x 总结归档 |
| task-5.x 原文件 | ✅ 退出主导航 | 外部不再引用 |

---

## 10. 差距与改进摘要 (Gap Analysis)

| 领域 | 当前状态 | Gap | 行动 |
|------|----------|-----|------|
| 学情分析 | 有统计框架，无推断算法说明 | 算法策略缺失 | 输出指标与算法白皮书草稿 |
| API 文档 | 单文件集中，结构扁平 | 不利于维护 | 模块化拆分 |
| 覆盖率 | 未量化 | 缺统一基线 | 集成 coverage + 阈值 |
| 可观测 | 有采集，无可视化与告警 | 无 dashboard | Prometheus 导出 + 看板预设 |
| 缓存 | 结构预留，未启用 | 熔断/雪崩策略缺失 | 设计缓存层（分层 TTL） |
| 安全运营 | 有密钥生成 | 无轮换制度 | 规定轮换周期 + 审计日志 |
| 前后端协同 | 响应结构明确 | 错误码索引缺 | 创建 `api/errors.md` |
| 文档一致性 | 拆分中 | 旧术语残留 | 术语表编制后批量清洗 |

---

## 11. 决策记录 (Lightweight ADR Pointers - 简化)

| 编号 | 决策 | 原因 | 状态 |
|------|------|------|------|
| ADR-01 | 采用 FastAPI + 异步 ORM | 快速迭代 + 类型提示友好 | 固定 |
| ADR-02 | 使用仓储 + 业务仓储分层 | 降低耦合 + 可测试性提高 | 固定 |
| ADR-03 | 限流采用 令牌桶 + 滑动窗口 组合 | 精细控制突发 + 平滑流量 | 固定 |
| ADR-04 | 自建性能监控中间件 | 灵活字段 + 无外部强依赖 | 固定 |
| ADR-05 | 文档拆分结构化（当前执行） | 降低单文件复杂度 | 执行中 |
| ADR-06 | 首版不引入消息队列 | 规模暂不需要 | 可复审 |
| ADR-07 | 先 SQLite dev → PostgreSQL prod | 快速启动 + 可扩展 | 固定 |

---

## 12. 附：维护规范 (Maintenance Rules Snapshot)

| 操作 | 规范 |
|------|------|
| 新增端点 | 增 `endpoints.md` + 模型引用，不写散文式重复 |
| 新增脚本 | `scripts/` 内 README 更新摘要 |
| 废弃功能 | 标记 @deprecated + 文档迁 history |
| 指标新增 | 更新 `OBSERVABILITY.md` 指标表 |
| 数据库变更 | Alembic 迁移 + MIGRATION 追加“变更目的”说明 |
| 版本发布 | 变更集 → CHANGELOG → STATUS 同步里程碑 |

---

## 13. 下一次状态快照建议时间

建议更新：2025-10-06（或出现任一：发布版本 / 架构调整 / 新指标上线）

---

本文件旨在为“管理层 / 技术负责人 / 新成员”提供统一的项目运行态与下一步行动依据。
如发现失真或过期，请发起 Issue 标记：`[status] 需更新`。

---
（END）
