---
trigger: always_on
alwaysApply: true
---

# 🤖 AI 协作开发指令

## 🎯 核心原则 (优先级: 最高)
**必须严格遵循以下规则，不可妥协：**

1. **代码安全**: 禁止硬编码凭证信息，所有敏感数据使用环境变量
2. **错误处理**: 使用具体异常类型，禁用裸露的 `except:`
3. **类型安全**: 所有函数必须包含完整类型注解
4. **算法复杂度**: 避免 O(n²) 及以上复杂度，提供复杂度分析

## 🛠 技术栈配置

### 主要语言
- **Python**: 使用 `uv` 管理依赖，Black 格式化 (line-length=88)
- **TypeScript**: 使用 `nvm` 管理版本，Prettier (printWidth=100) + ESLint

### 开发环境
- **系统**: macOS (Apple M4)
- **项目根目录**: `~/my-devs/`
- **目录结构**: 按技术栈分类 (`python/`, `typescript/`, `rust/` 等)

## 📝 代码规范

### 函数设计 (强制要求)
```python
def function_name(param: Type) -> ReturnType:
    """简洁明确的功能描述.
    
    Args:
        param: 参数说明
        
    Returns:
        返回值说明
        
    Raises:
        SpecificError: 特定错误条件
    """
    # 实现逻辑 (不超过 60 行)
```

### 检查清单
- [ ] 函数单一职责，长度 ≤ 60 行
- [ ] 完整类型注解 (Python/TypeScript)
- [ ] 具体异常处理，避免通用 `except`
- [ ] 核心逻辑包含单元测试 (`pytest`)
- [ ] 复杂算法提供时间/空间复杂度注释

## 📁 项目结构

### 标准目录布局
```
project-name/
├── src/                 # 核心代码
├── tests/              # 测试文件
├── docs/               # 文档
├── pyproject.toml      # Python 依赖 (锁定版本)
├── package.json        # Node.js 依赖 (锁定版本)
└── README.md          # 项目说明
```

### 必需文件内容
- **README.md**: 项目简介 + 安装步骤 + 使用示例 + API 文档
- **依赖文件**: 精确版本锁定，定期安全更新

## 🔀 Git 工作流

### 分支命名
- `feature/功能描述`: 新功能开发
- `fix/问题描述`: 错误修复
- `docs/文档类型`: 文档更新
- `refactor/重构范围`: 代码重构

### 提交格式 (强制)
```
类型(范围): 简洁描述

详细说明 (可选)

关联: #issue-number
```
**类型**: `feat`|`fix`|`docs`|`style`|`refactor`|`test`|`chore`

## 🎯 AI 协作指导

### 输出要求
1. **语言**: 始终使用中文响应
2. **解释深度**: 提供"怎么做" + "为什么" + "权衡分析"
3. **代码风格**: 直接生成符合规范的代码，避免示例代码块

### 上下文管理
- **大文件处理**: 优先读取关键代码段，避免全文加载
- **依赖分析**: 明确识别项目技术栈，保持一致性
- **增量开发**: 基于现有代码风格进行扩展

### 性能优化策略
1. **开发阶段**: 优先正确性和可读性
2. **性能分析**: 基于实际瓶颈数据进行优化
3. **资源监控**: 关注内存使用，避免深度递归

## 🔍 质量检查

### 代码审查要点
- [ ] 类型注解完整性
- [ ] 异常处理具体性
- [ ] 函数职责单一性
- [ ] 算法复杂度合理性
- [ ] 安全性 (无硬编码凭证)

### 测试覆盖
- **单元测试**: 核心功能 + 边界条件
- **集成测试**: 关键业务流程
- **性能测试**: 关键算法和数据处理

---