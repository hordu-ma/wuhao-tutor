<!--æ‰¹æ”¹ç»“æœå¡ç‰‡ç»„ä»¶-->
<view class="correction-card">
  <!-- æ‰¹æ”¹æ‘˜è¦å¡ç‰‡ -->
  <view class="summary-card">
    <view class="summary-header">
      <text class="summary-title">ğŸ“ ä½œä¸šæ‰¹æ”¹ç»“æœ</text>
      <text class="summary-score" wx:if="{{data.overall_score !== undefined}}">æ€»åˆ†: {{data.overall_score}}åˆ†</text>
    </view>
    
    <view class="summary-stats">
      <view class="stat-item">
        <text class="stat-number">{{data.total_questions}}</text>
        <text class="stat-label">æ€»é¢˜æ•°</text>
      </view>
      <view class="stat-item stat-correct">
        <text class="stat-number">{{correctCount}}</text>
        <text class="stat-label">æ­£ç¡®</text>
      </view>
      <view class="stat-item stat-error">
        <text class="stat-number">{{data.error_count || 0}}</text>
        <text class="stat-label">é”™è¯¯</text>
      </view>
      <view class="stat-item stat-unanswered">
        <text class="stat-number">{{data.unanswered_count || 0}}</text>
        <text class="stat-label">æœªä½œç­”</text>
      </view>
    </view>

    <view class="summary-text" wx:if="{{data.summary}}">
      <text>{{data.summary}}</text>
    </view>
  </view>

  <!-- é”™é¢˜åˆ—è¡¨ -->
  <view class="mistakes-section" wx:if="{{mistakes.length > 0}}">
    <view class="section-header">
      <text class="section-title">âŒ é”™é¢˜è¯¦æƒ… ({{mistakes.length}}é¢˜)</text>
    </view>

    <view class="mistake-list">
      <view class="mistake-item" wx:for="{{mistakes}}" wx:key="question_number">
        <view class="mistake-header">
          <text class="question-number">ç¬¬{{item.question_number}}é¢˜</text>
          <text class="question-type">{{item.question_type}}</text>
          <text class="error-badge" wx:if="{{item.error_type}}">{{item.error_type}}</text>
          <text class="unanswered-badge" wx:if="{{item.is_unanswered}}">æœªä½œç­”</text>
        </view>

        <!-- å­¦ç”Ÿç­”æ¡ˆ -->
        <view class="answer-block" wx:if="{{item.student_answer && !item.is_unanswered}}">
          <text class="answer-label">ä½ çš„ç­”æ¡ˆï¼š</text>
          <text class="answer-content student-answer">{{item.student_answer}}</text>
        </view>

        <!-- æ­£ç¡®ç­”æ¡ˆ -->
        <view class="answer-block" wx:if="{{item.correct_answer}}">
          <text class="answer-label">æ­£ç¡®ç­”æ¡ˆï¼š</text>
          <text class="answer-content correct-answer">{{item.correct_answer}}</text>
        </view>

        <!-- æ‰¹æ”¹è¯´æ˜ -->
        <view class="explanation-block" wx:if="{{item.explanation}}">
          <text class="explanation-label">ğŸ“– æ‰¹æ”¹è¯´æ˜ï¼š</text>
          <text class="explanation-content">{{item.explanation}}</text>
        </view>

        <!-- çŸ¥è¯†ç‚¹ -->
        <view class="knowledge-points" wx:if="{{item.knowledge_points && item.knowledge_points.length > 0}}">
          <text class="knowledge-label">ğŸ’¡ æ¶‰åŠçŸ¥è¯†ç‚¹ï¼š</text>
          <view class="knowledge-tags">
            <text class="knowledge-tag" wx:for="{{item.knowledge_points}}" wx:for-item="point" wx:key="*this">
              {{point}}
            </text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <view class="action-buttons">
    <button class="btn-primary" bindtap="goToMistakeBook" wx:if="{{mistakes.length > 0}}">
      ğŸ“š æŸ¥çœ‹é”™é¢˜æœ¬ ({{mistakes.length}}é¢˜)
    </button>
    <button class="btn-secondary" bindtap="retry" wx:if="{{mistakes.length === 0}}">
      âœ… å…¨å¯¹ï¼ç»§ç»­ç»ƒä¹ 
    </button>
  </view>
</view>
