<!--pages/login/index.wxml - 五好伴学小程序登录页面模板-->
<view class="container">
  <view class="login-content">
    <!-- Logo区域 -->
    <view class="logo-section">
      <view class="logo-placeholder">
        <text class="logo-text">五好伴学</text>
      </view>
      <text class="app-name">五好伴学</text>
      <text class="app-desc">AI智能学习助手</text>
    </view>

    <!-- 登录表单区域 -->
    <view class="login-form">
      <view class="welcome-text">
        <text class="welcome-title">欢迎使用五好伴学</text>
        <text class="welcome-desc">让学习更高效，让成长更快乐</text>
      </view>

      <!-- 网络状态提示 -->
      <view wx:if="{{networkStatus !== 'connected'}}" class="network-warning">
        <van-notice-bar
          left-icon="warning-o"
          text="网络连接不可用，请检查网络设置"
          mode="closeable"
          color="#ed6a0c"
          background="#fffbe8"
        />
      </view>

      <!-- 错误信息显示 -->
      <view wx:if="{{loginError}}" class="error-section">
        <view class="error-message">
          <van-icon name="warning-o" color="#ee0a24" />
          <text class="error-text">{{loginError}}</text>
        </view>
      </view>

      <!-- 手机号密码登录表单 -->
      <view class="form-section">
        <!-- 手机号输入 -->
        <van-field
          value="{{ phone }}"
          type="number"
          label="手机号"
          placeholder="{{ agreedToTerms ? '请输入手机号' : '请先同意协议' }}"
          maxlength="11"
          border="{{ true }}"
          bind:change="onPhoneChange"
          disabled="{{ !agreedToTerms }}"
          clearable
        >
          <van-icon slot="left-icon" name="phone-o" />
        </van-field>

        <!-- 密码输入 -->
        <van-field
          value="{{ password }}"
          type="{{ showPassword ? 'text' : 'password' }}"
          label="密码"
          placeholder="{{ agreedToTerms ? '请输入密码' : '请先同意协议' }}"
          border="{{ true }}"
          bind:change="onPasswordChange"
          disabled="{{ !agreedToTerms }}"
          clearable
        >
          <van-icon slot="left-icon" name="lock" />
          <van-icon 
            slot="right-icon" 
            name="{{ showPassword ? 'eye-o' : 'closed-eye' }}" 
            bind:tap="togglePassword"
          />
        </van-field>
      </view>

      <!-- 用户协议（移到登录按钮前面） -->
      <view class="agreement">
        <label class="agreement-label">
          <checkbox 
            class="agreement-checkbox" 
            checked="{{ agreedToTerms }}" 
            bindtap="onAgreementChange"
          />
          <view class="agreement-content">
            <text class="agreement-text">我已阅读并同意</text>
            <text class="agreement-link" catchtap="showUserAgreement">《用户服务协议》</text>
            <text class="agreement-text">及</text>
            <text class="agreement-link" catchtap="showPrivacyPolicy">《隐私政策》</text>
          </view>
        </label>
      </view>

      <!-- 登录按钮 -->
      <van-button
        class="login-btn"
        type="primary"
        size="large"
        round
        loading="{{loading}}"
        disabled="{{loading || networkStatus !== 'connected' || !agreedToTerms}}"
        bind:click="onLogin"
        loading-text="登录中..."
      >
        登录
      </van-button>
    </view>

    <!-- 底部装饰 -->
    <view class="footer">
      <text class="footer-text">专业的K12学习管理平台</text>
    </view>
  </view>
</view>
