## 五好伴学 — 用户使用手册（基于小程序端）

说明：本手册基于小程序前端代码编写，覆盖当前已实现的页面和交互（学生端为主，支持机构助学/辅导老师协同使用）。若遇到与手册不一致的界面，以小程序实时页面为准。

目录

- 快速准备
- 登录与角色选择
- 首页与常用导航
- 智能问答（学习问答）—— 核心交互详解
- 错题本与复习流程—— 列表、详情、三阶段复习
- 学情报告（学习报告）
- 个人中心（编辑、头像、设置、帮助）
- 常见问题与排查

### 快速准备

1. 使用微信打开小程序或在测试阶段用微信开发者工具导入 `miniprogram` 目录。
2. 本地开发请先在 `miniprogram/config/index.js` 中配置 `appId` 与后端 `api.baseUrl`。上线环境需在小程序后台配置服务器域名白名单。

### 登录与角色选择

- 登录方式：手机号+密码登录（登录页中需同意《用户服务协议》与《隐私政策》）。登录流程支持 Token 自动刷新与自动登录。
- 角色选择：登录后可在“角色选择”页面切换角色（学生/家长/教师/助学）。切换后会根据角色调整首页入口（例如家长默认进入学情页）。机构助学老师可切换为教师/助学角色以查看学生提交与复习会话。

注意：首次登录若检测到无有效 Token，系统会尝试刷新 Token；若失败，请重新登录。

### 首页与常用导航

- 首页显示：个性化推荐、统计数据（错题/作业/今日学习时长）和快捷入口（错题本、学习问答、学习报告、个人中心）。
- 常用导航：
  - 错题本：底部 Tab 的“错题本”图标或首页入口
  - 学习问答（AI）：通过首页或“作业问答”入口进入对话页面
  - 学习报告：底部 Tab 的“学习报告”入口
  - 个人中心：底部 Tab 的“我的”入口

下拉刷新与触底加载：多数列表页支持下拉刷新（Pull Down）和触底加载更多（Reach Bottom）。

### 智能问答（学习问答）—— 核心交互详解

（页面：`pages/learning/index/index`）

- 功能概览：支持文字输入、图片上传（最多 5 张）、语音输入。AI 返回逐步解析、参考题与练习建议。
- 会话管理：每次打开会创建或恢复一个会话（sessionId），草稿（输入框内容）会保存到本地，返回页面时自动恢复草稿。
- 输入限制：文本输入最大长度约 500 字；图片最大 5 张；语音会被上传并转写/处理。
- 推荐与快捷：页面提供快捷问题与学科快速切换（数学/语文/英语等），可直接点击模板问题快速发送。
- 自动滚动与历史：默认在底部时自动滚动，新消息到达自动向下滚动；当用户上滑查看历史时会暂停自动滚动并显示“返回顶部/返回底部”按钮。
- 断线与重连：页面会监听网络状态变化并尝试重连；AI 服务不可用时会提示但不阻塞本地会话创建（可离线生成本地 sessionId）。

使用建议：

- 拍照上传题目时，尽量保证题目完整、四角清晰、避免反光；对于公式或手写题，尽量靠近拍摄并保证清晰度。
- 语音输入适用于口述题目或快速复述思路；长篇讨论建议使用文字补充背景信息。
- 若要让 AI 将错题加入错题本，请在问答中明确指出“请把这道题加入我的错题本”。

限制说明：复杂主观题或开放性问答（主观作文、证明题）建议请机构助学老师复核答案与解析。

### 错题本与复习流程—— 列表、详情、三阶段复习

（页面：`pages/mistakes/list/index`、`pages/mistakes/detail/index`、`pages/mistakes/review/index`）

- 错题列表：支持按科目、难度、来源（学习问答/手动）和智能分类（不会做/答错/有难度）过滤，还支持按知识点筛选与关键字搜索。
- 列表操作：查看详情、删除错题（需二次确认）、开始复习、打开筛选弹窗、搜索、重置筛选。
- 手动添加：当前手动添加错题功能被提示为“已禁用”，建议通过学习问答由 AI 自动提取错题。

错题详情：

- 展示题干（支持图片预览）、参考答案、解析、难度、关联知识点与掌握状态（未掌握/复习中/已掌握）。
- 可从详情页发起复习会话或删除错题；若错题被删除会弹窗提示并返回列表。

三阶段复习（复习页）说明：

- 分为“原题复习 → 变体题挑战 → 知识点巩固”三个阶段。每阶段提交或跳过后系统会给出 AI 判定结果并决定是否进入下一阶段或结束复习。
- 提交答案后 AI 判定正确/错误：若正确且完成最终阶段，会显示完成结果并返回；若错误或跳过，会显示参考答案并返回详情页。
- 若启动复习会话失败，通常为网络或服务端问题；请稍后重试或联系管理员。

### 学情报告（学习报告）

（页面：`pages/analysis/report/index`）

- 报告内容：学习总览（题目数、会话数、作业数、学习时长）、按学科统计、近期表现趋势、知识点薄弱区域与改进建议。
- 时间范围：支持最近 7 天 / 30 天 / 90 天切换，切换时会重新加载数据。
- 导出与分享：页面提供“保存为图片 / 分享”入口，但当前实现为提示用户截图保存（Canvas 导出为图片为未来功能）。

使用建议：定期查看 7/30/90 天报告把握学习趋势，并将学生薄弱点与助学老师沟通以制定针对性练习。

### 个人中心（编辑、头像、设置、帮助）

（页面：`pages/profile/index`、`pages/profile/edit`、`pages/profile/settings`、`pages/profile/help`）

- 个人资料：可编辑昵称、年级、绑定手机号等；头像支持从相册选择并上传（上传成功后会同步至服务器并刷新缓存）。
- 设置：通知与提醒开关、密码修改、隐私设置等。
- 帮助中心：包含常见问题、用户服务协议与隐私政策的查看入口。

注意：个人信息在页面显示后会后台异步同步服务器数据，若修改后未立即生效可在个人中心下拉刷新或等待同步完成。

### 常见问题与排查

- 无法登录：检查网络，确认手机号/密码正确；如使用机构账号请联系管理员开通；若提示 Token 过期请重新登录。
- AI 无应答或长时间“AI 正在回复”：检查手机网络与后端 `api.baseUrl` 是否可达；如在开发环境请确认微信开发者工具的代理设置。
- 图片上传失败：检查网络、单张图片大小与微信上传限制（以及后端 OSS 配置）；建议压缩图片或分批上传。
- 无法启动复习会话：通常为服务端限制或限流（429），请稍后重试或反馈管理员。
- 页面显示异常或白屏：清理小程序缓存（在微信中长按小程序图标 → 清除缓存），或退出小程序重启；如仍异常，请提供控制台日志给开发人员。

---

如果你希望我把本手册生成带步骤截图的详尽版本、或针对机构助学老师制作一页操作指南（PPT 风格），我可以继续基于页面源码生成示例截图位置与文字说明。
