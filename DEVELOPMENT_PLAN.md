# 五好伴学 - 下一步开发计划 (V2.0)

> **目标**: 从“功能完整”到“智能驱动”，打造知识图谱赋能的个性化学习闭环。
> **核心**: 激活后端数据潜力，在小程序端提供可感知的、主动的智能引导。
> **版本**: 2.0 | **日期**: 2025-11-07

---

## 1. 现状与机遇

项目当前已具备极高的完成度和坚实的技术基础（四层架构、异步化、AI 服务封装）。小程序端的上线意味着用户交互的核心阵地已经明确。

**核心机遇**: 项目已成功构建了“数据采集”的闭环（用户行为 -> 错题 -> 知识点掌握度）。现在最大的机遇是将这些沉睡的数据激活，通过智能算法**反哺用户**，提供“我下一步该学什么？”的精准答案，实现学习效率的飞跃。

---

## 2. 核心开发路线图 (三步走)

### **第一阶段：激活知识图谱 (预计 2-3 周) -【体验突破】**

**目标**: 将后端的知识图谱数据，转化为小程序端用户可交互、可感知的核心功能。

1.  **小程序端知识图谱可视化 (前端)**

    - **技术栈**: 采用 `ec-canvas` + `ECharts Graph`。
    - **核心功能**:
      - **全局视图**: 渲染用户当前学科的完整知识图谱。节点根据**掌握度**（`KnowledgeMastery` 模型）进行着色（如：精通-绿色, 良好-蓝色, 薄弱-红色），让学习短板一目了然。
      - **交互与探索**:
        - 点击节点：弹窗显示该知识点的**掌握度分数**、**关联错题列表**（可跳转）、以及 AI 生成的**学习建议**。
        - 路径高亮：点击一个薄弱节点，自动高亮通向它的所有**前置知识点**（`prerequisite` 关系），形成清晰的“补课路径”。
    - **后端支持**:
      - 创建 `GET /api/v1/knowledge-graph/visualize` 接口，一次性返回 ECharts 所需的 `nodes` 和 `edges` 数据结构。

2.  **AI 驱动的图谱学习建议 (后端)**
    - **触发时机**: 用户在小程序端点击图谱节点时。
    - **实现**:
      - 在 `KnowledgeGraphService` 中新增 `generate_learning_suggestion(node_id)` 方法。
      - 该方法整合知识点信息、用户掌握度、关联错题数量，构建 Prompt 调用 `BailianService`。
      - **Prompt 示例**: "用户正在查看知识点‘二次函数根的判别式’，他对此掌握度为‘薄弱’，关联了 3 道错题。请为他生成一段 50 字左右的学习建议，鼓励他并指出复习重点。"

### **第二阶段：强化 AI 个性化记忆 (预计 1 周) -【效果立竿见影】**

**目标**: 让 AI 问答机器人从一个“通用博士”升级为“私人专属教师”。

1.  **默认注入“学情摘要”上下文 (后端)**

    - **位置**: 修改 `LearningService` 中处理用户提问的核心方法。
    - **逻辑**: 在构建发往 `BailianService` 的请求时，**强制**、**自动**地在 System Prompt 前置位注入用户的“学情摘要”。
    - **实现**: 调用 `KnowledgeContextBuilder` 服务，生成如 “背景：该学生数学比较优秀，但物理是短板，尤其在‘牛顿第二定律’和‘动量守恒’上反复出错。请在回答时考虑到这一点。” 的上下文。

2.  **优化 AI 角色与指令 (后端)**
    - **位置**: `BailianService` 的默认 Prompt 配置。
    - **指令强化**: 明确要求 AI：“你是一位熟悉该学生的私人辅导老师。请在回答问题的基础上，主动、简要地结合学生的薄弱知识点进行针对性提醒或扩展，但不要偏离主题。”

### **第三阶段：构建混合智能推荐引擎 (预计 2-3 周) -【智能闭环】**

**目标**: 将“今日复习”从一个被动的、基于规则的列表，升级为主动的、智能化的学习任务推荐系统。

1.  **创建 `RecommendationService` (后端)**

    - **职责**: 封装新一代的“今日待办”推荐逻辑。
    - **混合推荐算法**:
      - **召回层**:
        - **规则召回**: 艾宾浩斯遗忘曲线 (`SpacedRepetitionAlgorithm`) 到达复习窗口的错题。
        - **内容召回**: 与用户近期“高频薄弱知识点”关联的所有错题。
      - **排序层 (Scoring)**:
        - 为召回的每道题，根据以下权重综合打分：
          - `score = (w1 * forgetting_curve_urgency) + (w2 * knowledge_point_weakness) + (w3 * is_prerequisite_for_others)`
        - `w1, w2, w3` 为可配置权重。`is_prerequisite_for_others` 表示该题关联的知识点是否是其他薄弱知识点的前置，若是，则权重更高。

2.  **AI 生成“推荐理由” (后端)**

    - 在 `RecommendationService` 推荐出 Top 3 任务后，为每个任务调用 `BailianService` 生成一句话的推荐理由。
    - **Prompt 示例**: "为用户推荐复习错题‘[题目简介]’，该题的复习紧迫度是‘高’，关联的薄弱知识点是‘函数单调性’。请生成一句吸引人的推荐语。"

3.  **小程序端呈现 (前端)**
    - **位置**: 首页或“今日学习”页面。
    - **形式**: 将原有的简单列表升级为“任务卡片”。
    - **卡片内容**: 题目摘要、**AI 生成的推荐理由**、预计用时、关联知识点标签。

---

## 3. 实施与验证

- **开发顺序**: 建议按 **阶段二 → 阶段一 → 阶段三** 的顺序执行。阶段二改动小、见效快，能迅速提升核心体验；阶段一是视觉和交互的核心突破；阶段三是集大成者，形成最终的智能闭环。
- **验证**:
  - **阶段一**: 邀请用户测试，观察其在知识图谱页面的停留时长和交互频次。
  - **阶段二**: 对比开启“个性化记忆”前后，用户对 AI 回答的满意度反馈。
  - **阶段三**: 追踪开启“混合推荐”后，用户的日均复习完成率是否提升。

此计划旨在充分利用您已有的坚实成果，通过精准、智能化的升级，为用户创造核心价值。
